<app-bouton-retour></app-bouton-retour>

<div class="card">
  <h5 class="card-header bg-info fw-bolder">
    {{biere.nom}}
    <div class="float-end"><a (click)="editer()" class="pen btn btn-sm">
        <i class="fa-solid fa-pen"></i> Editer
      </a>
      <a (click)="onDelete()" class="trash btn btn-sm">
        <i class="fa-solid fa-trash"></i> Supprimer
      </a>
    </div>
  </h5>
</div>

<div class="container card">

  <!-- decription de la biere -->
  <div class="card-body indent">
    <br>
    <div class="row">
      <div class="col-lg-3 col-sm-6">
        <div class="cadrePhoto">
          <img class="photo" src="{{biere.imgUrl || './assets/beer.png'}}" alt="Image biere">
        </div>
        Code barre (EAN) : {{biere.ean || "Aucun code"}}
<br><br>
      </div>
      <div class="col-lg-3 col-sm-6">
        Type : <b>{{biere.type}}</b> 
        <br>
        Alcool : <b>{{biere.alcool}}%</b> 
        <br><br>
      </div>
      <div class="col-lg-6 col-sm-12">

        <div class="w-100 d-flex text-center fw-bold">
          <span [ngClass]="Math.floor(biere.note) == 0 ? 'noteBarre' : '' " class="col note-0">0</span>
          <span [ngClass]="Math.floor(biere.note) == 1 ? 'noteBarre' : '' " class="col note-1">1</span>
          <span [ngClass]="Math.floor(biere.note) == 2 ? 'noteBarre' : '' " class="col note-2">2</span>
          <span [ngClass]="Math.floor(biere.note) == 3 ? 'noteBarre' : '' " class="col note-3">3</span>
          <span [ngClass]="Math.floor(biere.note) == 4 ? 'noteBarre' : '' " class="col note-4">4</span>
          <span [ngClass]="Math.floor(biere.note) == 5 ? 'noteBarre' : '' " class="col note-5">5</span>
          <span [ngClass]="Math.floor(biere.note) == 6 ? 'noteBarre' : '' " class="col note-6">6</span>
          <span [ngClass]="Math.floor(biere.note) == 7 ? 'noteBarre' : '' " class="col note-7">7</span>
          <span [ngClass]="Math.floor(biere.note) == 8 ? 'noteBarre' : '' " class="col note-8">8</span>
          <span [ngClass]="Math.floor(biere.note) == 9 ? 'noteBarre' : '' " class="col note-9">9</span>
          <span [ngClass]="Math.floor(biere.note) == 10 ? 'noteBarre' : '' " class="col note-10">10</span>
        </div>
        <br>
       <b>{{biere.nb_notes}}</b> note(s) soit <b>{{biere.note}}/10</b> 
        
      </div>

    </div>
  </div>


</div>
<br>
<div class="card">
  <div class="card-header bg-info ">
    <i class="fa-solid fa-plus"></i>
    Ajouter une note
  </div>
  <div class="card-body">
    <form class="row " (ngSubmit)="onAddNote()">
      <div class="col-lg-1 col-sm-1">
        <label for="note">Note</label>
        <input type="number" [(ngModel)]="newNotes.note" name="note" id="note" max="10" min="0" required>
      </div>
      <div class="col-lg-4 col-sm-7">
        <label for="commentaire">Commentaire</label>
        <input type="text" [(ngModel)]="newNotes.commentaire" name="commentaire" id="commentaire" required>
      </div>
      <div class="col-lg-2 col-sm-2 ">
        <label for="date">Date</label>
        <input type="date" [(ngModel)]="this.newNotes.date" name="date" id="date" required>
      </div>
      <div class="col-lg-2 col-sm-2 ">
        <label for="auteur">Auteur</label>
        <ng-select *ngIf="users.length > 0" [items]="users" bindLabel="surnom" bindValue="id"
          placeholder="Chercher une personne" [searchable]="true" (change)="onPersonneChange($event.id)">
        </ng-select>
        <span class="form-text" *ngIf="users.length === 0"><br>Aucun cr√©er...</span>
      </div>
      <div class="col-lg-2 col-sm-2">
        <br>
        <button type="submit" class="btn btn-info p-1 border border-info ajout">
          Ajouter <i class="fa-solid fa-arrow-right"></i>
        </button>
      </div>
    </form>
  </div>
</div>
<br>


<!-- liste des notes -->
<div class="card">
  <div class="card-header bg-info ">
    <i class="fa-solid fa-list"></i>
    Liste des notes
  </div>

  <div class="card-body indent">

    <table *ngIf="notes.length > 0" class="table table-striped">
      <thead>
        <tr>
          <th scope="col" class="table-head" (click)="sortTable('note')"
            [attr.data-sort]="sortColumn === 'note' ? sortDirection : ''">Note</th>
          <th scope="col" class="table-head" [attr.data-sort]="sortColumn === 'commentaire' ? sortDirection : ''">
            Commentaire</th>
          <th scope="col" class="table-head" (click)="sortTable('date')"
            [attr.data-sort]="sortColumn === 'date' ? sortDirection : ''">Date</th>
          <th scope="col" class="table-head">Auteur</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let note of notes" class="slide">
          <td>{{ note.note }}</td>
          <td>{{ note.commentaire }}</td>
          <td>{{ note.date }}</td>
          <td>{{ usersById[note.userId].surnom }}</td>
        </tr>
      </tbody>
    </table>
    <span *ngIf="notes.length <= 0">Aucune note pour cette biere </span>

  </div>

</div>